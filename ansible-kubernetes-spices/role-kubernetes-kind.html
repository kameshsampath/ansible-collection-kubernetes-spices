<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Ansible Collection Kubernetes Spices :: Ansible Collection Kubernetes Spices</title>
    <link rel="canonical" href="https://kameshsampath.github.com/kubernetes_spices/ansible-kubernetes-spices/role-kubernetes-kind.html">
    <link rel="prev" href="common-variables.html">
    <link rel="next" href="role-kubernetes-spices.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../_/css/site.css">
    <script>var uiRootPath = '../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://kameshsampath.github.com/kubernetes_spices">Ansible Collection Kubernetes Spices</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ansible-kubernetes-spices" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Ansible Collection Kubernetes Spices</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="setup.html">Setup</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="setup.html#prerequisite">Prerequisites</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="common-variables.html">Roles</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="role-kubernetes-kind.html">KinD</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="role-kubernetes-spices.html">Kubernetes Spices</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="role-kubernetes-spices.html#deploy-isito">Deploy Istio</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="role-kubernetes-spices.html#deploy-knative">Deploy Knative</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="role-kubernetes-spices.html#deploy-gloo-edge">Deploy Gloo Edge</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="role-kubernetes-spices.html#deploy-tektoncd">Deploy Tekton</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="common-variables.html">Common Variables</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="running.html">Running Playbooks</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Ansible Collection Kubernetes Spices</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="index.html">Ansible Collection Kubernetes Spices</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Ansible Collection Kubernetes Spices</a></li>
    <li><a href="common-variables.html">Roles</a></li>
    <li><a href="role-kubernetes-kind.html">KinD</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/kameshsampath/kubernetes_spices/edit/main/documentation/modules/ROOT/pages/role-kubernetes-kind.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Ansible Collection Kubernetes Spices</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="https://github.com/kameshsampath/kubernetes_spices/tree/main/roles/kind">kind</a> role helps to create/destroy a <a href="https://kind.sigs.k8s.io">KinD</a> cluster.</p>
</div>
<div class="paragraph">
<p><code>Role Name</code>: <code>kameshsampath.kubernetes_spices.kind</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="kind-ansible-vars"><a class="anchor" href="#kind-ansible-vars"></a>KinD Ansible Variables</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. KinD Ansible Variables</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cluster_name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the KinD cluster to be created</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kind</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">kind_create</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">To create the KinD cluster or not, accepts <code>true</code> or <code>false</code>. Setting this to <code>false</code> will destroy an existing cluster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">kind_network_name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The docker network name to use to KinD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kind</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">kind_ip_family</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The ip family to be used with KinD Kubernetes cluster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ipv4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">kind_home_dir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The KinD home directory where the created KinD configuration will be stored. Each cluster created wil have config file named <code>cluster-name/kind-cluster-config.yaml</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$HOME/.kind</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">kind_cluster_config</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The cluster config file name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kind_cluster_config</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">kind_create_config</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create the KinD configuration file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">kind_custom_registry</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create the custom KinD registry named <code>kind-registry.local</code>, which could used for the Kubernetes applications to push and pull container images</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">kind_custom_registry_aliases</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The registry aliases that can be used to identify the registry, accepts a list of values</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">  - example.com
  - example.org
  - test.com
  - test.org</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">container_registry_name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The custom container registry name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kind-registry.local</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">container_registry_port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The custom container registry port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">extra_port_mappings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The extra port mappings that could be used to reach various services from the host, accepts a list of values of the format <code>&lt;ip&gt;:host-port:container-port</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">  - "0.0.0.0:80:80"
  - "0.0.0.0:443:443"
  - "0.0.0.0:30080:30080"
  - "0.0.0.0:30443:30443"</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">disable_cni</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ability to disable the default <code>kindnetd</code> network plugin and deploy a custom network plugin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="kind-example-playbooks"><a class="anchor" href="#kind-example-playbooks"></a>Example playbooks</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="kind-example-playbooks-create"><a class="anchor" href="#kind-example-playbooks-create"></a>KinD cluster with all defaults</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">---
- name: vanilla
  hosts: localhost
  connection: local

  collections:
    - kubernetes.core

  vars:
    ansible_python_interpreter: "{{ ansible_playbook_python }}"
    cluster_name: vanilla
    kind_create: true

  roles:
    - role: kameshsampath.kubernetes_spices.kind</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_destroy_kind_cluster"><a class="anchor" href="#_destroy_kind_cluster"></a>Destroy KinD cluster</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">---
- name: Converge
  hosts: localhost
  connection: local

  collections:
    - kubernetes.core

  vars:
    ansible_python_interpreter: "{{ ansible_playbook_python }}"
    kind_create: false <i class="conum" data-value="1"></i><b>(1)</b>
  roles:
    - role: kameshsampath.kubernetes_spices.kind</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_kind_cluster_with_ipv6"><a class="anchor" href="#_kind_cluster_with_ipv6"></a>KinD cluster with ipv6</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">---
- name: vanilla
  hosts: localhost
  connection: local

  collections:
    - kubernetes.core

  vars:
    ansible_python_interpreter: "{{ ansible_playbook_python }}"
    cluster_name: vanilla
    # valid values are ipv4, ipv6, dual
    kind_ip_family: ipv6
    # Create Cluster
    kind_create: true
    # Destroy Cluster
    kind_destroy: false

  roles:
    - role: kameshsampath.kubernetes_spices.kind</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="kind-with-istio"><a class="anchor" href="#kind-with-istio"></a>KinD cluster with Istio</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">---
- name: "Demo with Istio"
  hosts: localhost
  connection: local

  collections:
    - kubernetes.core
    - kameshsampath.kubernetes_spices

  vars:
    ansible_python_interpreter: "{{ ansible_playbook_python }}"
    cluster_name: kind-istio
    kind_create: true
    ####
    ## Istio Configurations
    ####
    deploy_istio: true <i class="conum" data-value="1"></i><b>(1)</b>
    ## Istio Ingress Gateway
    deploy_istio_gateway: true <i class="conum" data-value="2"></i><b>(2)</b>
    istio_versions: <i class="conum" data-value="3"></i><b>(3)</b>
      - "1.10.2"

  roles:
    - kameshsampath.kubernetes_spices.k8s_app_spices</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="kind-with-gloo-edge-ce"><a class="anchor" href="#kind-with-gloo-edge-ce"></a>KinD cluster with Gloo Edge CE</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">---
- name: "Gloo Edge Enterprise Demo"
  hosts: localhost
  connection: local

  collections:
    - kubernetes.core
    - kameshsampath.kubernetes_spices

  vars:
    ansible_python_interpreter: "{{ ansible_playbook_python }}"
    cluster_name: kind-gloo-ce
    kind_create: true
    ## Gloo Edge Configuration
    ####
    # Gloo Edge Setup
    deploy_gloo_edge: true <i class="conum" data-value="1"></i><b>(1)</b>
    # Enable/disable discovery true/false
    gloo_discovery_enabled: false <i class="conum" data-value="2"></i><b>(2)</b>
    # Namespace to install Gloo into
    gloo_write_namespace: my-gloo <i class="conum" data-value="3"></i><b>(3)</b>
    # Gloo Watch Namespaces
    gloo_watch_namespaces: <i class="conum" data-value="4"></i><b>(4)</b>
      - demo-1-8-6
      - demo-1-10-2
      - my-gloo
    # Use NodePorts for Gloo Proxy http/https true/false
    gloo_proxy_nodeport: true <i class="conum" data-value="5"></i><b>(5)</b>

  roles:
    - kameshsampath.kubernetes_spices.kind
    - kameshsampath.kubernetes_spices.k8s_app_spices</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="kind-with-gloo-edge-ee"><a class="anchor" href="#kind-with-gloo-edge-ee"></a>KinD cluster with Gloo Edge EE</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">---
- name: "Gloo Edge Enterprise Demo"
  hosts: localhost
  connection: local

  collections:
    - kubernetes.core
    - kameshsampath.kubernetes_spices

  vars:
    ansible_python_interpreter: "{{ ansible_playbook_python }}"
    cluster_name: kind-gloo-ee
    kind_create: true
    ####
    ## Gloo Edge Configuration
    ####
    # Gloo Edge Setup
    deploy_gloo_edge: true <i class="conum" data-value="1"></i><b>(1)</b>
    # deploy Gloo Edge Enterprise
    gloo_edge_edition: "ee" <i class="conum" data-value="2"></i><b>(2)</b>
    # Set Gloo Edge Enterprise License Key
    gloo_license_key: "{{ ansible_env.GLOO_LICENSE_KEY }}" <i class="conum" data-value="3"></i><b>(3)</b>
    # Enable/disable discovery true/false
    gloo_discovery_enabled: false <i class="conum" data-value="4"></i><b>(4)</b>
    # Namespace to install Gloo into
    gloo_write_namespace: my-gloo <i class="conum" data-value="5"></i><b>(5)</b>
    # Gloo Watch Namespaces
    gloo_watch_namespaces: <i class="conum" data-value="6"></i><b>(6)</b>
      - demo-1-8-6
      - demo-1-10-2
      - my-gloo
    # Use NodePorts for Gloo Proxy http/https true/false
    gloo_proxy_nodeport: true <i class="conum" data-value="7"></i><b>(7)</b>

  roles:
    - kameshsampath.kubernetes_spices.kind
    - kameshsampath.kubernetes_spices.k8s_app_spices</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="kind-with-knative"><a class="anchor" href="#kind-with-knative"></a>KinD cluster with Knative</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">---
- name: "Knative Defaults"
  hosts: localhost
  connection: local

  collections:
    - kubernetes.core

  vars:
    cluster_name: kind-knative
    kind_create: true
    # to ensure we are on python3
    ansible_python_interpreter: "{{ ansible_playbook_python }}"
    # Default versions are v0.23.0, you can override it using knative_serving_version, knative_eventing_version
    deploy_knative: True <i class="conum" data-value="1"></i><b>(1)</b>

  roles:
    - role: kameshsampath.kubernetes_spices.kind
    - role: kameshsampath.kubernetes_spices.k8s_app_spices</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="kind-with-tektoncd"><a class="anchor" href="#kind-with-tektoncd"></a>KinD cluster with Tektoncd</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">---
- name: "Tektoncd Defaults"
  hosts: localhost
  connection: local

  collections:
    - kubernetes.core

  vars:
    cluster_name: kind-tektoncd
    kind_create: true
    deploy_tektoncd: true <i class="conum" data-value="1"></i><b>(1)</b>

  roles:
    - role: kameshsampath.kubernetes_spices.kind
    - role: kameshsampath.kubernetes_spices.k8s_app_spices</code></pre>
</div>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="common-variables.html">Roles</a></span>
  <span class="next"><a href="role-kubernetes-spices.html">Kubernetes Spices</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
