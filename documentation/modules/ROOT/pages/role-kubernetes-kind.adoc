=  KinD Role
include::_attributes.adoc[]

The https://github.com/kameshsampath/kubernetes_spices/tree/main/roles/kind[kind] role helps to create/destroy a https://kind.sigs.k8s.io[KinD] cluster. This always spins a 2 Node cluster with one master and one worker.

`Role Name`: `kameshsampath.kubernetes_spices.kind`

[#kind-ansible-vars]
== KinD Ansible Variables

.KinD Ansible Variables
|===
| Name | Description | Default Value

| cluster_name
| The name of the KinD cluster to be created
| kind

| kind_create
| To create the KinD cluster or not, accepts `true` or `false`. Setting this to `false` will destroy an existing cluster
| false

| kind_network_name
| The docker network name to use to KinD
| kind

| kind_ip_family
| The ip family to be used with KinD Kubernetes cluster
| ipv4

| kind_home_dir
| The KinD home directory where the created KinD configuration will be stored. Each cluster created wil have config file named `cluster-name/kind-cluster-config.yaml`
| $HOME/.kind

| kind_cluster_config
| The cluster config file name
| kind_cluster_config

| kind_create_config
| Create the KinD configuration file
| true

| kind_custom_registry
| Create the custom KinD registry named `kind-registry.local`, which could used for the Kubernetes applications to push and pull container images
| true

| kind_custom_registry_aliases
| The registry aliases that can be used to identify the registry, accepts a list of values
a|
[source,yaml]
----
  - example.com
  - example.org
  - test.com
  - test.org
----

| container_registry_name
| The custom container registry name
| kind-registry.local

| container_registry_port
| The custom container registry port
| 5000

| extra_port_mappings
| The extra port mappings that could be used to reach various services from the host, accepts a list of values of the format `<ip>:host-port:container-port`. These mappings are applied on Control Plane container.
a|
[source,yaml]
----
  - "0.0.0.0:80:80"
  - "0.0.0.0:443:443"
  - "0.0.0.0:30080:30080"
  - "0.0.0.0:30443:30443"
----

| extra_port_mappings_off
| Don't apply any extra port mappings
| false


| worker_extra_port_mappings
| The extra port mappings that could be used to reach various services from the host, accepts a list of values of the format `<ip>:host-port:container-port`. These mappings are applied on worker node container.
a|
[source,yaml]
----
  - "0.0.0.0:5432:5432"
  - "0.0.0.0:3306:3306"
  - "0.0.0.0:27017:27017"
  - "0.0.0.0:8080:8080"
  - "0.0.0.0:8443:8443"
----
| worker_extra_port_mappings_off
| Don't apply any worker extra port mappings
| false

| disable_cni
| Ability to disable the default `kindnetd` network plugin and deploy a custom network plugin
| false

|===

[#kind-example-playbooks]
== Example playbooks

[#kind-example-playbooks-create]
=== KinD cluster with all defaults

[source,yaml]
----
include::example$kind-vanilla.yaml[]
----

=== Destroy KinD cluster

[source,yaml]
----
include::example$kind-destroy.yaml[]
----

=== KinD cluster with ipv6

[source,yaml]
----
include::example$kind-vanilla-ipv6.yaml[]
----

[#kind-with-gloo-edge-ce]
=== KinD cluster with Gloo Edge CE

[source,yaml]
----
include::example$kind-gloo-edge-ce.yml[]
----

[#kind-with-gloo-edge-ee]
=== KinD cluster with Gloo Edge EE

[source,yaml]
----
include::example$kind-gloo-edge-ee.yml[]
----

[#kind-with-istio]
=== KinD cluster with Istio

[source,yaml]
----
include::example$kind-istio.yml[]
----

[#kind-with-knative]
=== KinD cluster with Knative

[source,yaml]
----
include::example$kind-knative.yml[]
----

[#kind-with-keycloak]
=== KinD cluster with Keycloak

[source,yaml]
----
include::example$kind-keycloak.yml[]
----

[#kind-with-tektoncd]
=== KinD cluster with Tektoncd

[source,yaml,indent=0]
----
include::example$kind-tektoncd.yml[]
----
